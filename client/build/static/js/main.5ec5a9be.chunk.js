(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{57:function(e,t,n){},58:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(0),s=n.n(i),a=n(49),o=n.n(a),r=(n(57),n(58),n(21)),u=n(2),d=n(7);function h(e){var t=e.gameId,n=Object(i.useState)(!1),s=Object(d.a)(n,2),a=s[0],o=s[1];return Object(c.jsxs)("div",{className:"sub-container",children:[Object(c.jsxs)("div",{className:"m-1",children:["Share this link with your opponent: ",Object(c.jsx)("span",{className:"copy-url",children:"https://dv-chess.herokuapp.com/game/"+t})]}),Object(c.jsx)("button",{onClick:function(){return o(!0)},children:"Join Game"}),a&&Object(c.jsx)(u.a,{to:"/game/"+t})]})}var j=function(){var e=Object(i.useState)(""),t=Object(d.a)(e,2),n=t[0],s=t[1];return Object(c.jsxs)("div",{className:"main-container",children:[Object(c.jsxs)("div",{className:"sub-container",children:[Object(c.jsx)("h1",{children:"Chess"}),Object(c.jsx)("p",{children:"Play Chess with your friends!"}),Object(c.jsx)("button",{onClick:function(){fetch("game/create",{method:"POST"}).then((function(e){return e.json()})).then((function(e){"success"===e.status?s(e.data.id):"error"===e.status&&console.error(e.message)})).catch(console.error.bind(console))},children:"Create Game"})]}),""!==n&&Object(c.jsx)(h,{gameId:n})]})},l=n(51),b=n.n(l);var v=function(){var e=Object(u.g)().gameId,t=Object(i.useState)(null),n=Object(d.a)(t,2),s=n[0],a=n[1],o=Object(i.useState)(!1),r=Object(d.a)(o,2),h=r[0],j=r[1],l=Object(i.useState)(),v=Object(d.a)(l,2),f=v[0],m=v[1],p=Object(i.useState)([]),O=Object(d.a)(p,2),g=O[0],x=O[1],E=Object(i.useState)({position:"absolute",top:0,left:0}),T=Object(d.a)(E,2),L=T[0],w=T[1],S=Object(i.useState)(null),y=Object(d.a)(S,2),k=y[0],C=y[1],N=Object(i.useMemo)((function(){for(var e=[],t=function(t){var n={},c=Math.floor(t/8),i=t%8;n.id="white"===f?"abcdefgh"[i]+(8-c):"hgfedcba"[i]+(c+1),n.piece=null,g.forEach((function(e){e.square===n.id&&(n.piece=e)})),e.push(n)},n=0;n<64;n++)t(n);return e}),[g,f]);Object(i.useEffect)((function(){var t=b()();return t.emit("join",e),t.on("join failed",(function(e){console.log("join failed: "+e),j(!0)})),t.on("game data",(function(e){e.white===t.id?m("white"):e.black===t.id&&m("black"),x(e.pieces)})),a(t),function(){t.disconnect()}}),[e]);var Y=Object(i.useRef)();return Object(i.useEffect)((function(){var e=function(e){var t=Math.min(window.innerWidth,window.innerHeight)/16,n=e.changedTouches?e.changedTouches[0].pageX:e.pageX,c=e.changedTouches?e.changedTouches[0].pageY:e.pageY;w({position:"absolute",left:n-t+"px",top:c-t+"px"})},t=function(t){var n=t.changedTouches?t.changedTouches[0].clientX:t.clientX,c=t.changedTouches?t.changedTouches[0].clientY:t.clientY,i=document.elementFromPoint(n,c).id,s=N.find((function(e){return e.id===i}));s&&s.piece&&(t.preventDefault(),C(s.piece),e(t))},n=function(e){if(k){e.preventDefault();var t=e.changedTouches?e.changedTouches[0].clientX:e.clientX,n=e.changedTouches?e.changedTouches[0].clientY:e.clientY,c=document.elementFromPoint(t,n).id,i=N.find((function(e){return e.id===c}));if(i&&!i.piece){var a=k.square;x((function(e){var t=e.slice(),n=t.indexOf(k);return t[n]=Object.assign(k,{square:i.id}),t})),s.emit("move",a,i.id)}C(null)}},c=function(t){k&&(t.preventDefault(),e(t))},i=Y.current;return i.addEventListener("touchmove",c,{passive:!1}),i.addEventListener("mousemove",c),i.addEventListener("touchstart",t,{passive:!1}),i.addEventListener("mousedown",t),i.addEventListener("touchend",n,{passive:!1}),i.addEventListener("mouseup",n),function(){i.removeEventListener("touchmove",c,{passive:!1}),i.removeEventListener("mousemove",c),i.removeEventListener("touchstart",t,{passive:!1}),i.removeEventListener("mousedown",t),i.removeEventListener("touchend",n,{passive:!1}),i.removeEventListener("mouseup",n)}}),[N,k,s]),Object(c.jsxs)("div",{ref:Y,children:[Object(c.jsxs)("h1",{children:["This is game ",e]}),Object(c.jsxs)("h2",{children:["You are playing as ",f]}),h&&Object(c.jsx)(u.a,{to:"/"}),Object(c.jsx)("div",{id:"board",children:N.map((function(e){return Object(c.jsx)("div",{id:e.id,className:"square",children:e.piece&&Object(c.jsx)("div",{className:"piece "+e.piece.player+"-"+e.piece.type,style:k===e.piece?L:{}})},e.id)}))})]})};var f=function(){return Object(c.jsx)(r.a,{children:Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(u.d,{children:[Object(c.jsx)(u.b,{path:"/game/:gameId",children:Object(c.jsx)(v,{})}),Object(c.jsx)(u.b,{exact:!0,path:"/",children:Object(c.jsx)(j,{})}),Object(c.jsx)(u.b,{path:"*",children:Object(c.jsx)(u.a,{to:"/"})})]})})})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,94)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),s(e),a(e)}))};o.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(f,{})}),document.getElementById("root")),m()}},[[93,1,2]]]);
//# sourceMappingURL=main.5ec5a9be.chunk.js.map