{"version":3,"sources":["HomePage.js","GamePage.js","App.js","reportWebVitals.js","index.js"],"names":["NewGame","id","useState","joinGame","setJoinGame","className","process","onClick","to","HomePage","newGameId","setNewGameId","fetch","method","then","res","json","status","data","console","error","message","catch","bind","GamePage","useParams","joinFailed","setJoinFailed","side","setSide","pieces","setPieces","position","top","left","absPos","setAbsPos","draggedPiece","setDraggedPiece","squares","useEffect","endDrag","document","addEventListener","removeEventListener","socket","io","emit","on","reason","log","game","white","black","disconnect","trackMouse","e","pointerEvents","pageX","window","innerHeight","pageY","i","push","j","square","name","piece","forEach","onMouseMove","map","row","rowNum","onMouseUp","newPieces","slice","index","indexOf","Object","assign","player","type","onMouseDown","startDrag","style","App","path","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.d953dd36.chunk.js","sourcesContent":["import { useState } from 'react'\r\nimport { Redirect } from 'react-router-dom'\r\n\r\nfunction HomePage() {\r\n\r\n  const [newGameId, setNewGameId] = useState('')\r\n\r\n  const createGame = () => {\r\n    fetch('game/create', {\r\n      method: 'POST',\r\n    }).then((res) => {\r\n      return res.json()\r\n    }).then((json) => {\r\n      if (json.status === 'success') {\r\n        setNewGameId(json.data.id)\r\n      } else if (json.status === 'error') {\r\n        console.error(json.message)\r\n      }\r\n    }).catch(console.error.bind(console))\r\n  }\r\n\r\n  return (\r\n    <div className=\"main-container\">\r\n      <div className=\"sub-container\">\r\n        <h1>Chess</h1>\r\n        <p>\r\n          Play Chess with your friends!\r\n        </p>\r\n        <button onClick={createGame}>Create Game</button>\r\n      </div>\r\n      {newGameId !== '' && <NewGame id={newGameId}/>}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction NewGame({ id }) {\r\n  const [joinGame, setJoinGame] = useState(false)\r\n\r\n\treturn (\r\n    <div className=\"sub-container\">\r\n      <div className=\"m-1\">\r\n      Share this link with your opponent:&nbsp;\r\n      <span className=\"copy-url\">{process.env.REACT_APP_BASEURL + '/game/' + id}</span>\r\n      </div>\r\n      <button onClick={() => setJoinGame(true)}>Join Game</button>\r\n      {joinGame && <Redirect to={'/game/' + id} />}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HomePage","import { useEffect, useState } from 'react'\r\nimport { Redirect, useParams } from 'react-router-dom'\r\nimport io from 'socket.io-client'\r\n\r\nfunction GamePage() {\r\n\tconst { id } = useParams()\r\n\tconst [joinFailed, setJoinFailed] = useState(false)\r\n\tconst [side, setSide] = useState()\r\n\tconst [pieces, setPieces] = useState([])\r\n\tconst [absPos, setAbsPos] = useState({ position: 'absolute', top: 0, left: 0 })\r\n\tconst [draggedPiece, setDraggedPiece] = useState(null)\r\n\r\n\tconst squares = []\r\n\r\n\t// release dragged pieces if mouseup happens off of the board\r\n\tuseEffect(() => {\r\n\t\tconst endDrag = () => {\r\n\t\t\tsetDraggedPiece(null)\r\n\t\t}\r\n\t\tdocument.addEventListener('mouseup', endDrag)\r\n\t\treturn () => document.removeEventListener('mouseup', endDrag)\r\n\t}, [])\r\n\r\n\t// connect to game\r\n\tuseEffect(() => {\r\n\t\tconst socket = io()\r\n\t\tsocket.emit('join', id)\r\n\r\n\t\tsocket.on('join failed', (reason) => {\r\n\t\t\tconsole.log('join failed: ' + reason)\r\n\t\t\tsetJoinFailed(true) // will cause redirect to home\r\n\t\t})\r\n\r\n\t\tsocket.on('game data', (game) => {\r\n\t\t\tif (game.white === socket.id) {\r\n\t\t\t\tsetSide('white')\r\n\t\t\t} else if (game.black === socket.id) {\r\n\t\t\t\tsetSide('black')\r\n\t\t\t}\r\n\t\t\tsetPieces(game.pieces)\r\n\t\t})\r\n\r\n\t\treturn function cleanup() {\r\n\t\t\tsocket.disconnect()\r\n\t\t}\r\n\r\n\t}, [id])\r\n\r\n\tconst trackMouse = (e) => {\r\n\t\tsetAbsPos({\r\n\t\t\tposition: 'absolute',\r\n\t\t\tpointerEvents: 'none',\r\n\t\t\tleft: e.pageX - window.innerHeight / 16 + 'px',\r\n\t\t\ttop: e.pageY - window.innerHeight / 16 + 'px'\r\n\t\t})\r\n\t}\r\n\r\n\tconst startDrag = (e, square) => {\r\n\t\tsetDraggedPiece(square.piece)\r\n\t\ttrackMouse(e)\r\n\t}\r\n\r\n\tconst endDrag = (square => {\r\n\t\tif (draggedPiece) {\r\n\t\t\tsetPieces((pieces) => {\r\n\t\t\t\tconst newPieces = pieces.slice()\r\n\t\t\t\tconst index = newPieces.indexOf(draggedPiece)\r\n\t\t\t\tnewPieces[index] = Object.assign(draggedPiece, { square: square.name })\r\n\t\t\t\treturn newPieces\r\n\t\t\t})\r\n\t\t\tsetDraggedPiece(null)\r\n\t\t}\r\n\t})\r\n\r\n\t// initialize squares\r\n\tfor (let i = 0; i < 8; i++) {\r\n\t\tsquares.push([])\r\n\t\tfor (let j = 0; j < 8; j++) {\r\n\t\t\tconst square = {}\r\n\t\t\tsquare.name = (side === 'white') ? 'abcdefgh'[j] + (8 - i) : 'hgfedcba'[j] + (i + 1)\r\n\t\t\tsquare.piece = null\r\n\r\n\t\t\t// if there is a piece on this square add it\r\n\t\t\tpieces.forEach((piece) => {\r\n\t\t\t\tif (piece.square === square.name) {\r\n\t\t\t\t\tsquare.piece = piece\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tsquares[i].push(square)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div onMouseMove={trackMouse}>\r\n\t\t\t<h1>This is game {id}</h1>\r\n\t\t\t<h2>You are playing as {side}</h2>\r\n\t\t\t{joinFailed && <Redirect to=\"/\"/>}\r\n\t\t\t{squares.map((row, rowNum) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"row\" key={(rowNum + 1)}>{\r\n\t\t\t\t\t\trow.map((square) => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div className=\"square\" key={square.name} onMouseUp={() => endDrag(square)}>\r\n\t\t\t\t\t\t\t\t\t{square.piece && draggedPiece !== square.piece &&\r\n\t\t\t\t\t\t\t\t\t<div className={'piece ' + square.piece.player + '-' + square.piece.type}\r\n\t\t\t\t\t\t\t\t\t\tonMouseDown={(e) => startDrag(e, square)}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}</div>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t\t{draggedPiece &&\r\n\t\t\t<div className={'piece ' + draggedPiece.player + '-' + draggedPiece.type} style={absPos}/>}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default GamePage","import './App.css';\r\n\r\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\r\n\r\nimport HomePage from './HomePage.js'\r\nimport GamePage from './GamePage.js'\r\n\r\nfunction App() {\r\n\r\n  return (\r\n    <Router>\r\n      <div className=\"App\">\r\n        <Switch>\r\n          <Route path=\"/game/:id\">\r\n            <GamePage />\r\n          </Route>\r\n          <Route exact path=\"/\">\r\n            <HomePage />\r\n          </Route>\r\n          <Route path=\"*\">\r\n            <Redirect to=\"/\"/>\r\n          </Route>\r\n        </Switch>\r\n      </div>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}